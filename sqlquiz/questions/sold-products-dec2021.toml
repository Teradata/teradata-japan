# IDはユニークな文字列であれば何でも良いが、なるべくこの形式で（たぶん並べ替えやすいので）
qid = "q00000111"

# タグは文字列の配列。なしでもよい。
# タグには言語の区別はなくても良いだろう。
tags = [
  "date",
  "join"
]


# カテゴリは必ず１つの文字列。問題の分類に用いる
# 使用できるカテゴリ一覧は別途用意する
[category]
ja = "SQL/Teradata 基礎"
en = "SQL/Teradata Basic"

[title]
ja = "2021年12月に売り上げた商品"
en = "Sold products in December 2021"

[content]
ja = """<em>TeraShirt.store_sales</em> テーブルには、TeraShirt社の売上の情報が格納されています。
また <em>TeraShirt.product</em> テーブルには、TeraShirt社の商品の情報が格納されています。<br />
2021年12月に売り上げた商品について、売り上げた日時、顧客のID、商品のID及び商品名を表示してください。
"""
en = """<em>TeraShirt.store_sales</em> table stores the information of sales of the TeraShirt company.
<em>TeraShirt.product</em> table stores the information of products of the TeraShirt company.<br />
For sold products in December 2021, show the timestamp, customer ID, product ID and product name.
"""


[hint]
ja = "両方のテーブルに商品のIDが含まれています。"
en = "Both tables include the product ID."


[references]
ja = ""
en = ""


# 正誤判定に関する定義
[judgement]
check_shape = true         # クエリ結果の行列数の一致を求めるか
shape = [103, 4]           # 想定されたクエリ結果のサイズ

check_type = true          # クエリ結果の列の型の一致を求めるか
types = [ "str", "int", "int", "str" ]         # 想定されたクエリ結果の変数型

check_value = true         # 想定解との値の一致を求めるか
ordered = false            # クエリ結果の並び順が指定されているかどうか
value_from = "csv"         # 想定結果の指定方法
                           # csv      : 想定結果のCSV文字列を指定
                           # query    : 想定結果を生成するクエリを指定。動的に実行して判定する
csv = """
purchase_timestamp,customer_id,product_id,product_name
2021-12-16 19:00:29+09:00,117,19,"Tシャツ (Men, S, white)"
2021-12-27 15:00:01+09:00,,122,"パーカー (Women, XS, orange)"
2021-12-14 14:00:29+09:00,,162,"パーカー (Kids, L, black)"
2021-12-31 11:00:13+09:00,105,19,"Tシャツ (Men, S, white)"
2021-12-18 16:00:56+09:00,37,17,"Tシャツ (Women, XS, white)"
2021-12-25 20:00:39+09:00,,158,"パーカー (Women, M, black)"
2021-12-02 14:00:48+09:00,,19,"Tシャツ (Men, S, white)"
2021-12-11 16:00:37+09:00,,17,"Tシャツ (Women, XS, white)"
2021-12-29 13:00:25+09:00,,15,"Tシャツ (Kids, XL, orange)"
2021-12-19 10:00:06+09:00,,59,"Tシャツ (Women, XL, gray)"
2021-12-17 13:00:10+09:00,,139,"パーカー (Men, S, white)"
2021-12-09 13:00:04+09:00,,55,"Tシャツ (Men, L, gray)"
2021-12-02 13:00:15+09:00,,59,"Tシャツ (Women, XL, gray)"
2021-12-28 10:00:46+09:00,79,156,"パーカー (Kids, S, black)"
2021-12-01 10:00:20+09:00,,55,"Tシャツ (Men, L, gray)"
2021-12-02 19:00:53+09:00,,116,"ロングT (Women, L, gray)"
2021-12-06 17:00:25+09:00,,156,"パーカー (Kids, S, black)"
2021-12-10 20:00:27+09:00,35,95,"ロングT (Women, S, black)"
2021-12-23 16:00:54+09:00,,133,"パーカー (Men, XL, orange)"
2021-12-21 10:00:12+09:00,,13,"Tシャツ (Men, XL, orange)"
2021-12-07 13:00:24+09:00,,95,"ロングT (Women, S, black)"
2021-12-09 17:00:50+09:00,,91,"ロングT (Men, XS, black)"
2021-12-12 10:00:24+09:00,,32,"Tシャツ (Women, XS, black)"
2021-12-19 15:00:46+09:00,110,72,"ロングT (Kids, L, orange)"
2021-12-21 17:00:04+09:00,,152,"パーカー (Women, XS, black)"
2021-12-18 15:00:47+09:00,,154,"パーカー (Men, S, black)"
2021-12-05 18:00:08+09:00,58,30,"Tシャツ (Kids, XL, white)"
2021-12-28 16:00:31+09:00,,131,"パーカー (Women, L, orange)"
2021-12-21 14:00:34+09:00,,51,"Tシャツ (Kids, S, gray)"
2021-12-30 20:00:31+09:00,,150,"パーカー (Kids, XL, white)"
2021-12-01 17:00:48+09:00,,131,"パーカー (Women, L, orange)"
2021-12-26 17:00:47+09:00,31,9,"Tシャツ (Kids, M, orange)"
2021-12-16 13:00:13+09:00,41,127,"パーカー (Men, M, orange)"
2021-12-05 12:00:12+09:00,,129,"パーカー (Kids, M, orange)"
2021-12-11 15:00:49+09:00,,89,"ロングT (Women, XL, white)"
2021-12-25 16:00:17+09:00,,85,"ロングT (Men, L, white)"
2021-12-12 15:00:31+09:00,,108,"ロングT (Kids, XS, gray)"
2021-12-14 17:00:20+09:00,,89,"ロングT (Women, XL, white)"
2021-12-03 14:00:50+09:00,,165,"パーカー (Kids, XL, black)"
2021-12-09 19:00:06+09:00,,26,"Tシャツ (Women, L, white)"
2021-12-09 16:00:34+09:00,,68,"ロングT (Women, M, orange)"
2021-12-20 14:00:45+09:00,,140,"パーカー (Women, S, white)"
2021-12-11 18:00:00+09:00,,146,"パーカー (Women, L, white)"
2021-12-28 14:00:22+09:00,,87,"ロングT (Kids, L, white)"
2021-12-02 15:00:51+09:00,,140,"パーカー (Women, S, white)"
2021-12-07 11:00:50+09:00,,146,"パーカー (Women, L, white)"
2021-12-10 12:00:26+09:00,,83,"ロングT (Women, M, white)"
2021-12-06 17:00:25+09:00,,117,"ロングT (Kids, L, gray)"
2021-12-05 18:00:08+09:00,58,41,"Tシャツ (Women, L, black)"
2021-12-21 11:00:36+09:00,77,83,"ロングT (Women, M, white)"
2021-12-31 20:00:54+09:00,,35,"Tシャツ (Women, S, black)"
2021-12-14 16:00:38+09:00,107,20,"Tシャツ (Women, S, white)"
2021-12-29 12:00:10+09:00,,142,"パーカー (Men, M, white)"
2021-12-06 17:00:25+09:00,,157,"パーカー (Men, M, black)"
2021-12-06 11:00:43+09:00,,60,"Tシャツ (Kids, XL, gray)"
2021-12-17 13:00:15+09:00,86,121,"パーカー (Men, XS, orange)"
2021-12-04 19:00:48+09:00,,157,"パーカー (Men, M, black)"
2021-12-18 15:00:31+09:00,,58,"Tシャツ (Men, XL, gray)"
2021-12-31 11:00:13+09:00,105,121,"パーカー (Men, XS, orange)"
2021-12-27 16:00:40+09:00,100,94,"ロングT (Men, S, black)"
2021-12-29 14:00:14+09:00,,180,"パーカー (Kids, XL, gray)"
2021-12-07 16:00:46+09:00,,119,"ロングT (Women, XL, gray)"
2021-12-04 16:00:55+09:00,,155,"パーカー (Women, S, black)"
2021-12-18 16:00:38+09:00,87,98,"ロングT (Women, M, black)"
2021-12-03 19:00:16+09:00,92,16,"Tシャツ (Men, XS, white)"
2021-12-07 12:00:37+09:00,,92,"ロングT (Women, XS, black)"
2021-12-16 14:00:04+09:00,,56,"Tシャツ (Women, L, gray)"
2021-12-09 19:00:45+09:00,,14,"Tシャツ (Women, XL, orange)"
2021-12-21 20:00:55+09:00,26,50,"Tシャツ (Women, S, gray)"
2021-12-04 14:00:56+09:00,,56,"Tシャツ (Women, L, gray)"
2021-12-24 19:00:06+09:00,,14,"Tシャツ (Women, XL, orange)"
2021-12-27 14:00:33+09:00,,50,"Tシャツ (Women, S, gray)"
2021-12-10 12:00:26+09:00,,113,"ロングT (Women, M, gray)"
2021-12-23 15:00:14+09:00,102,153,"パーカー (Kids, XS, black)"
2021-12-31 13:00:15+09:00,44,50,"Tシャツ (Women, S, gray)"
2021-12-12 13:00:01+09:00,,90,"ロングT (Kids, XL, white)"
2021-12-14 16:00:41+09:00,,10,"Tシャツ (Men, L, orange)"
2021-12-02 19:00:53+09:00,,50,"Tシャツ (Women, S, gray)"
2021-12-31 11:00:13+09:00,105,151,"パーカー (Men, XS, black)"
2021-12-14 17:00:20+09:00,,29,"Tシャツ (Women, XL, white)"
2021-12-11 16:00:37+09:00,,109,"ロングT (Men, S, gray)"
2021-12-27 13:00:09+09:00,54,151,"パーカー (Men, XS, black)"
2021-12-01 16:00:28+09:00,,29,"Tシャツ (Women, XL, white)"
2021-12-02 14:00:48+09:00,,107,"ロングT (Women, XS, gray)"
2021-12-07 17:00:08+09:00,72,130,"パーカー (Men, L, orange)"
2021-12-12 16:00:47+09:00,,69,"ロングT (Kids, M, orange)"
2021-12-20 18:00:28+09:00,55,147,"パーカー (Kids, L, white)"
2021-12-01 17:00:17+09:00,,130,"パーカー (Men, L, orange)"
2021-12-04 13:00:50+09:00,,46,"Tシャツ (Men, XS, gray)"
2021-12-19 18:00:15+09:00,,147,"パーカー (Kids, L, white)"
2021-12-14 14:00:28+09:00,118,128,"パーカー (Women, M, orange)"
2021-12-17 14:00:23+09:00,,86,"ロングT (Women, L, white)"
2021-12-23 20:00:17+09:00,,105,"ロングT (Kids, XL, black)"
2021-12-09 16:00:34+09:00,,25,"Tシャツ (Men, L, white)"
2021-12-03 19:00:07+09:00,24,65,"ロングT (Women, S, orange)"
2021-12-06 13:00:59+09:00,,25,"Tシャツ (Men, L, white)"
2021-12-02 15:00:51+09:00,,103,"ロングT (Men, XL, black)"
2021-12-09 17:00:40+09:00,,126,"パーカー (Kids, S, orange)"
2021-12-11 14:00:13+09:00,38,143,"パーカー (Women, M, white)"
2021-12-12 19:00:32+09:00,,126,"パーカー (Kids, S, orange)"
2021-12-23 16:00:54+09:00,,166,"パーカー (Men, XS, gray)"
2021-12-17 13:00:15+09:00,86,145,"パーカー (Men, L, white)"
2021-12-06 17:00:25+09:00,,21,"Tシャツ (Kids, S, white)"
"""
#query = 
query = """
SELECT
  s.purchase_timestamp, s.customer_id, s.product_id, p.name
FROM
  TeraShirt.store_sales AS s
  INNER JOIN TeraShirt.product AS p
    ON s.product_id = p.product_id
WHERE
  purchase_date BETWEEN DATE'2021-12-01' AND DATE'2021-12-31'
"""

check_explain = false